apiVersion: v1
kind: ConfigMap
metadata:
  name: storage-worker-config
  namespace: bluesky
  annotations:
    argocd.argoproj.io/sync-wave: "0"
data:
  storage-worker.yaml: |
    kafka:
      bootstrap_servers: kafka.bluesky.svc.cluster.local:9092
      topic: bluesky-events
      group_id: bluesky-storage-workers
      auto_offset_reset: earliest
      enable_auto_commit: false

    s3:
      endpoint_url: http://minio.minio.svc.cluster.local
      bucket: bluesky-data
      region: us-east-1
      access_key_id: ${S3_ACCESS_KEY_ID}
      secret_access_key: ${S3_SECRET_ACCESS_KEY}

    storage:
      buffer_size: 10000
      flush_interval_seconds: 60
      partition_format: year={year}/month={month}/day={day}/hour={hour}

    health:
      port: 8080