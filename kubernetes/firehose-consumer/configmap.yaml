apiVersion: v1
kind: ConfigMap
metadata:
  name: firehose-consumer-config
  namespace: bluesky
  annotations:
    argocd.argoproj.io/sync-wave: "0"
data:
  firehose-consumer.yaml: |
    firehose:
      # Jetstream endpoint with collection filtering
      # Filters for: posts, likes, reposts, follows, blocks
      # Note: Posts include regular posts, replies, and quote posts (all same type)
      # Note: Mutes are private state and not available in firehose
      endpoint: wss://jetstream2.us-east.bsky.network/subscribe?wantedCollections=app.bsky.feed.post&wantedCollections=app.bsky.feed.like&wantedCollections=app.bsky.feed.repost&wantedCollections=app.bsky.graph.follow&wantedCollections=app.bsky.graph.block
      reconnect_delay: 5
      max_reconnect_delay: 300

    kafka:
      bootstrap_servers: redpanda.bluesky.svc.cluster.local:9092
      topic: bluesky-events
      compression_type: snappy
      batch_size: 1000
      linger_ms: 100

    health:
      port: 8080